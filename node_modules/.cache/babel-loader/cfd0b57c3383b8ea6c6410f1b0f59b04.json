{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\src\\\\views\\\\search-report\\\\search-report.jsx\";\nimport React, { Component } from 'react';\nimport Page from 'layouts/page-admin';\nimport Autosuggest from 'react-autosuggest';\nimport './src.css';\nimport { Row, Col, Button, ListGroupItem, ListGroup } from 'reactstrap';\nimport app from 'app';\nimport download from 'downloadjs';\nimport Loading from 'layouts/loading-modal';\nimport Select from 'react-select';\n\nvar SearchReport =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SearchReport, _Component);\n\n  function SearchReport() {\n    var _this;\n\n    _classCallCheck(this, SearchReport);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SearchReport).call(this));\n\n    _this.getSuggestions = function (value) {\n      var laporan = _this.state.laporan;\n      var inputValue = value.trim().toLowerCase();\n      var inputLength = inputValue.length;\n      return inputLength === 0 ? [] : laporan.filter(function (x) {\n        return x.REPOSITORY.toLowerCase().slice(0, inputLength) === inputValue;\n      });\n    };\n\n    _this.getSuggestionValue = function (suggestion) {\n      return suggestion.REPOSITORY;\n    };\n\n    _this.renderSuggestion = function (suggestion) {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, suggestion.REPOSITORY);\n    };\n\n    _this.onChange = function (event, _ref) {\n      var newValue = _ref.newValue;\n\n      _this.setState({\n        value: newValue\n      });\n    };\n\n    _this.onSuggestionsFetchRequested = function (_ref2) {\n      var value = _ref2.value;\n\n      _this.setState({\n        suggestions: _this.getSuggestions(value)\n      });\n    };\n\n    _this.onSuggestionsClearRequested = function () {\n      _this.setState({\n        suggestions: []\n      });\n    };\n\n    _this.Search = function () {\n      var value = _this.state.value;\n      app.apiGet1('search/file', value || 'test').then(function (res) {\n        _this.setState({\n          result: res\n        });\n      });\n    };\n\n    _this.mode = function () {\n      _this.setState({\n        modal: !_this.state.modal\n      });\n    };\n\n    _this.FilterResult = function (e) {\n      _this.setState({\n        filtervalue: e.value\n      });\n    };\n\n    _this.state = {\n      value: '',\n      suggestions: [],\n      laporan: [],\n      result: [],\n      modal: false,\n      accperiod: [],\n      filtervalue: '',\n      currentPage: 1,\n      todosPerPage: 3\n    };\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(SearchReport, [{\n    key: \"handleClick\",\n    value: function handleClick(event) {\n      this.setState({\n        currentPage: Number(event.target.id)\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      var user = app.dataUser[0].ACCESS;\n      var dpt = app.dataUser[0].IDDPT || 'IDO';\n      app.apiGet2('search/repo', user, dpt).then(function (res) {\n        _this2.setState({\n          laporan: res\n        });\n      });\n      app.apiGet('accperiod').then(function (res) {\n        _this2.setState({\n          accperiod: res\n        });\n      });\n    }\n  }, {\n    key: \"Downloadfile\",\n    value: function () {\n      var _Downloadfile = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(id, name) {\n        var res, blob;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.mode();\n                _context.next = 3;\n                return fetch(app.proxy + 'downloadfile/' + id, {\n                  method: 'get',\n                  headers: app.head2\n                });\n\n              case 3:\n                res = _context.sent;\n\n                if (!res) {\n                  _context.next = 11;\n                  break;\n                }\n\n                _context.next = 7;\n                return res.blob();\n\n              case 7:\n                blob = _context.sent;\n                download(blob, name);\n                this.mode();\n                app.apiGet1('deletefile', id);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function Downloadfile(_x, _x2) {\n        return _Downloadfile.apply(this, arguments);\n      }\n\n      return Downloadfile;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          value = _this$state.value,\n          suggestions = _this$state.suggestions,\n          result = _this$state.result,\n          filtervalue = _this$state.filtervalue,\n          currentPage = _this$state.currentPage,\n          todosPerPage = _this$state.todosPerPage;\n      var inputProps = {\n        placeholder: 'Cari Laporan Anda',\n        value: value,\n        onChange: this.onChange\n      };\n      var indexOfLastTodo = currentPage * todosPerPage;\n      var indexOfFirstTodo = indexOfLastTodo - todosPerPage;\n      var currentTodos = result.slice(indexOfFirstTodo, indexOfLastTodo);\n      var pageNumbers = [];\n\n      for (var i = 1; i <= Math.ceil(result.length / todosPerPage); i++) {\n        pageNumbers.push(i);\n      }\n\n      var renderPageNumbers = pageNumbers.map(function (number) {\n        return React.createElement(\"li\", {\n          key: number,\n          id: number,\n          onClick: _this3.handleClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }, number);\n      });\n      var data = result.filter(function (x) {\n        return x.ID_PERIOD.toLowerCase().includes(filtervalue.toLowerCase());\n      });\n      return React.createElement(Page, {\n        head: 'Pencarian Laporan',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(Loading, {\n        modal: this.state.modal,\n        text: 'Proses Download',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }), React.createElement(Row, {\n        className: \"mb-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(Col, {\n        md: \"12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(Autosuggest, {\n        suggestions: suggestions,\n        onSuggestionsFetchRequested: this.onSuggestionsFetchRequested,\n        onSuggestionsClearRequested: this.onSuggestionsClearRequested,\n        getSuggestionValue: this.getSuggestionValue,\n        renderSuggestion: this.renderSuggestion,\n        inputProps: inputProps,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }))), React.createElement(Button, {\n        color: \"primary\",\n        onClick: this.Search,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, \" Search \"), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), currentTodos.length === 0 ? React.createElement(\"div\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, \" Data Tidak Ada \")) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row mb-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(Select, {\n        id: \"period\",\n        className: \"col-3\",\n        onChange: this.FilterResult,\n        placeholder: 'Filter Periode',\n        options: this.state.accperiod.map(function (x) {\n          return {\n            value: x.VCIDACCPERIOD,\n            label: x.VCDESCRIPTION\n          };\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }), React.createElement(Button, {\n        color: \"danger\",\n        size: \"sm\",\n        onClick: function onClick() {\n          return _this3.setState({\n            filtervalue: ''\n          });\n        },\n        className: \"col-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, \"Clear Filter\")), data.map(function (x) {\n        return React.createElement(ListGroup, {\n          flush: true,\n          key: x.ID_FILE,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, React.createElement(ListGroupItem, {\n          className: \"list-group-item-action flex-column align-items-start py-4 px-4\",\n          onClick: function onClick(e) {\n            return e.preventDefault();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"d-flex w-100 justify-content-between\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"d-flex w-100 align-items-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209\n          },\n          __self: this\n        }, React.createElement(Button, {\n          size: \"sm\",\n          color: \"success\",\n          onClick: function onClick() {\n            return _this3.Downloadfile(x.ID_FILE, x.ORIGINAL_NAME);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        }, \" Download \"))), React.createElement(\"small\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213\n          },\n          __self: this\n        }, \"\".concat(x.DIVISION, \" \").concat(x.PERIODE))), React.createElement(\"h4\", {\n          className: \"mt-3 mb-1\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, x.REPO), React.createElement(\"p\", {\n          className: \"text-sm mb-0\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218\n          },\n          __self: this\n        }, \"\".concat(x.JENIS_REPO, \" \").concat(x.TEMPLATE_NAME, \" \").concat(x.DTUPLOAD))));\n      })));\n    }\n  }]);\n\n  return SearchReport;\n}(Component);\n\nexport { SearchReport as default };","map":{"version":3,"sources":["D:\\job\\web\\Midas\\Midas-Client\\src\\views\\search-report\\search-report.jsx"],"names":["React","Component","Page","Autosuggest","Row","Col","Button","ListGroupItem","ListGroup","app","download","Loading","Select","SearchReport","getSuggestions","value","laporan","state","inputValue","trim","toLowerCase","inputLength","length","filter","x","REPOSITORY","slice","getSuggestionValue","suggestion","renderSuggestion","onChange","event","newValue","setState","onSuggestionsFetchRequested","suggestions","onSuggestionsClearRequested","Search","apiGet1","then","res","result","mode","modal","FilterResult","e","filtervalue","accperiod","currentPage","todosPerPage","handleClick","bind","Number","target","id","user","dataUser","ACCESS","dpt","IDDPT","apiGet2","apiGet","name","fetch","proxy","method","headers","head2","blob","inputProps","placeholder","indexOfLastTodo","indexOfFirstTodo","currentTodos","pageNumbers","i","Math","ceil","push","renderPageNumbers","map","number","data","ID_PERIOD","includes","VCIDACCPERIOD","label","VCDESCRIPTION","ID_FILE","preventDefault","Downloadfile","ORIGINAL_NAME","DIVISION","PERIODE","REPO","JENIS_REPO","TEMPLATE_NAME","DTUPLOAD"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAO,WAAP;AACA,SAASC,GAAT,EACSC,GADT,EAESC,MAFT,EAGSC,aAHT,EAISC,SAJT,QAKe,YALf;AAMA,OAAOC,GAAP,MAAgB,KAAhB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,MAAP,MAAmB,cAAnB;;IAGqBC,Y;;;;;AACjB,0BAAc;AAAA;;AAAA;;AACV;;AADU,UAyCZC,cAzCY,GAyCK,UAAAC,KAAK,EAAI;AAAA,UAClBC,OADkB,GACN,MAAKC,KADC,CAClBD,OADkB;AAExB,UAAME,UAAU,GAAGH,KAAK,CAACI,IAAN,GAAaC,WAAb,EAAnB;AACA,UAAMC,WAAW,GAAGH,UAAU,CAACI,MAA/B;AAEA,aAAOD,WAAW,KAAK,CAAhB,GAAoB,EAApB,GAAyBL,OAAO,CAACO,MAAR,CAAe,UAAAC,CAAC;AAAA,eAC9CA,CAAC,CAACC,UAAF,CAAaL,WAAb,GAA2BM,KAA3B,CAAiC,CAAjC,EAAoCL,WAApC,MAAqDH,UADP;AAAA,OAAhB,CAAhC;AAID,KAlDW;;AAAA,UAqDZS,kBArDY,GAqDS,UAAAC,UAAU;AAAA,aAAIA,UAAU,CAACH,UAAf;AAAA,KArDnB;;AAAA,UAuDZI,gBAvDY,GAuDO,UAAAD,UAAU;AAAA,aAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGA,UAAU,CAACH,UADd,CAD2B;AAAA,KAvDjB;;AAAA,UA6DZK,QA7DY,GA6DD,UAACC,KAAD,QAAyB;AAAA,UAAfC,QAAe,QAAfA,QAAe;;AAClC,YAAKC,QAAL,CAAc;AACZlB,QAAAA,KAAK,EAAEiB;AADK,OAAd;AAGD,KAjEW;;AAAA,UAmEZE,2BAnEY,GAmEkB,iBAAe;AAAA,UAAZnB,KAAY,SAAZA,KAAY;;AAC3C,YAAKkB,QAAL,CAAc;AACZE,QAAAA,WAAW,EAAE,MAAKrB,cAAL,CAAoBC,KAApB;AADD,OAAd;AAID,KAxEW;;AAAA,UA0EZqB,2BA1EY,GA0EkB,YAAM;AAClC,YAAKH,QAAL,CAAc;AACZE,QAAAA,WAAW,EAAE;AADD,OAAd;AAGD,KA9EW;;AAAA,UAgFZE,MAhFY,GAgFJ,YAAI;AAAA,UACFtB,KADE,GACQ,MAAKE,KADb,CACFF,KADE;AAERN,MAAAA,GAAG,CAAC6B,OAAJ,CAAY,aAAZ,EAA0BvB,KAAK,IAAI,MAAnC,EACIwB,IADJ,CACS,UAAAC,GAAG,EAAG;AACR,cAAKP,QAAL,CAAc;AAAEQ,UAAAA,MAAM,EAAED;AAAV,SAAd;AACH,OAHJ;AAKH,KAvFW;;AAAA,UAyFZE,IAzFY,GAyFN,YAAI;AACR,YAAKT,QAAL,CAAc;AACVU,QAAAA,KAAK,EAAE,CAAC,MAAK1B,KAAL,CAAW0B;AADT,OAAd;AAGF,KA7FY;;AAAA,UAkHbC,YAlHa,GAkHE,UAACC,CAAD,EAAK;AACjB,YAAKZ,QAAL,CAAc;AAAEa,QAAAA,WAAW,EAAED,CAAC,CAAC9B;AAAjB,OAAd;AACF,KApHY;;AAEV,UAAKE,KAAL,GAAa;AACXF,MAAAA,KAAK,EAAE,EADI;AAEXoB,MAAAA,WAAW,EAAE,EAFF;AAGXnB,MAAAA,OAAO,EAAE,EAHE;AAIXyB,MAAAA,MAAM,EAAE,EAJG;AAKXE,MAAAA,KAAK,EAAE,KALI;AAMXI,MAAAA,SAAS,EAAC,EANC;AAOXD,MAAAA,WAAW,EAAC,EAPD;AAQXE,MAAAA,WAAW,EAAE,CARF;AASXC,MAAAA,YAAY,EAAE;AATH,KAAb;AAWA,UAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,uDAAnB;AAbU;AAcX;;;;gCAEWpB,K,EAAO;AACjB,WAAKE,QAAL,CAAc;AACZe,QAAAA,WAAW,EAAEI,MAAM,CAACrB,KAAK,CAACsB,MAAN,CAAaC,EAAd;AADP,OAAd;AAGD;;;yCAEmB;AAAA;;AAClB,UAAIC,IAAI,GAAG9C,GAAG,CAAC+C,QAAJ,CAAa,CAAb,EAAgBC,MAA3B;AACA,UAAIC,GAAG,GAAGjD,GAAG,CAAC+C,QAAJ,CAAa,CAAb,EAAgBG,KAAhB,IAAyB,KAAnC;AAEAlD,MAAAA,GAAG,CAACmD,OAAJ,CAAY,aAAZ,EAA0BL,IAA1B,EAAiCG,GAAjC,EACInB,IADJ,CACS,UAAAC,GAAG,EAAE;AACP,QAAA,MAAI,CAACP,QAAL,CAAc;AAAEjB,UAAAA,OAAO,EAAEwB;AAAX,SAAd;AACH,OAHJ;AAKA/B,MAAAA,GAAG,CAACoD,MAAJ,CAAW,WAAX,EACItB,IADJ,CACS,UAAAC,GAAG,EAAG;AACV,QAAA,MAAI,CAACP,QAAL,CAAc;AACZc,UAAAA,SAAS,EAAEP;AADC,SAAd;AAIJ,OAND;AAOD;;;;;;gDAyDkBc,E,EAAKQ,I;;;;;;AAEtB,qBAAKpB,IAAL;;uBAEgBqB,KAAK,CAACtD,GAAG,CAACuD,KAAJ,GAAU,eAAV,GAA0BV,EAA3B,EAA+B;AAChDW,kBAAAA,MAAM,EAAE,KADwC;AAEhDC,kBAAAA,OAAO,EAAEzD,GAAG,CAAC0D;AAFmC,iBAA/B,C;;;AAAjB3B,gBAAAA,G;;qBAKAA,G;;;;;;uBACcA,GAAG,CAAC4B,IAAJ,E;;;AAAbA,gBAAAA,I;AAEJ1D,gBAAAA,QAAQ,CAAC0D,IAAD,EAAQN,IAAR,CAAR;AACA,qBAAKpB,IAAL;AACAjC,gBAAAA,GAAG,CAAC6B,OAAJ,CAAY,YAAZ,EAAyBgB,EAAzB;;;;;;;;;;;;;;;;;;6BAUI;AAAA;;AAAA,wBAE6E,KAAKrC,KAFlF;AAAA,UAEGF,KAFH,eAEGA,KAFH;AAAA,UAEUoB,WAFV,eAEUA,WAFV;AAAA,UAEwBM,MAFxB,eAEwBA,MAFxB;AAAA,UAEiCK,WAFjC,eAEiCA,WAFjC;AAAA,UAEgDE,WAFhD,eAEgDA,WAFhD;AAAA,UAE6DC,YAF7D,eAE6DA,YAF7D;AAIL,UAAMoB,UAAU,GAAG;AACnBC,QAAAA,WAAW,EAAE,mBADM;AAEnBvD,QAAAA,KAAK,EAALA,KAFmB;AAGnBe,QAAAA,QAAQ,EAAE,KAAKA;AAHI,OAAnB;AAMA,UAAMyC,eAAe,GAAGvB,WAAW,GAAGC,YAAtC;AACA,UAAMuB,gBAAgB,GAAGD,eAAe,GAAGtB,YAA3C;AACA,UAAMwB,YAAY,GAAGhC,MAAM,CAACf,KAAP,CAAa8C,gBAAb,EAA+BD,eAA/B,CAArB;AAGA,UAAMG,WAAW,GAAG,EAApB;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIC,IAAI,CAACC,IAAL,CAAUpC,MAAM,CAACnB,MAAP,GAAgB2B,YAA1B,CAArB,EAA8D0B,CAAC,EAA/D,EAAmE;AACjED,QAAAA,WAAW,CAACI,IAAZ,CAAiBH,CAAjB;AACD;;AAED,UAAMI,iBAAiB,GAAGL,WAAW,CAACM,GAAZ,CAAgB,UAAAC,MAAM,EAAI;AAClD,eACE;AACE,UAAA,GAAG,EAAEA,MADP;AAEE,UAAA,EAAE,EAAEA,MAFN;AAGE,UAAA,OAAO,EAAE,MAAI,CAAC/B,WAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAKG+B,MALH,CADF;AASD,OAVyB,CAA1B;AAYA,UAAMC,IAAI,GAAIzC,MAAM,CAAClB,MAAP,CAAc,UAAAC,CAAC,EAAI;AAC7B,eAAOA,CAAC,CAAC2D,SAAF,CAAY/D,WAAZ,GAA0BgE,QAA1B,CAAmCtC,WAAW,CAAC1B,WAAZ,EAAnC,CAAP;AACH,OAFa,CAAd;AAIA,aACI,oBAAC,IAAD;AAAM,QAAA,IAAI,EAAE,mBAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,OAAD;AAAS,QAAA,KAAK,EAAE,KAAKH,KAAL,CAAW0B,KAA3B;AAAkC,QAAA,IAAI,EAAE,iBAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI,oBAAC,GAAD;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAC,IAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA,oBAAC,WAAD;AACI,QAAA,WAAW,EAAER,WADjB;AAEI,QAAA,2BAA2B,EAAE,KAAKD,2BAFtC;AAGI,QAAA,2BAA2B,EAAE,KAAKE,2BAHtC;AAII,QAAA,kBAAkB,EAAE,KAAKT,kBAJ7B;AAKI,QAAA,gBAAgB,EAAE,KAAKE,gBAL3B;AAMI,QAAA,UAAU,EAAEwC,UANhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,CADJ,CAFJ,EAcI,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,SAAd;AAAwB,QAAA,OAAO,EAAE,KAAKhC,MAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAdJ,EAeI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAfJ,EAiBQoC,YAAY,CAACnD,MAAb,KAAwB,CAAxB,GAA4B;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAA7B,CAA5B,GAA0F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAC1F;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,MAAD;AAAQ,QAAA,EAAE,EAAC,QAAX;AAAoB,QAAA,SAAS,EAAC,OAA9B;AAAsC,QAAA,QAAQ,EAAE,KAAKsB,YAArD;AAAmE,QAAA,WAAW,EAAE,gBAAhF;AAAmG,QAAA,OAAO,EAAE,KAAK3B,KAAL,CAAW8B,SAAX,CAAqBiC,GAArB,CAAyB,UAACxD,CAAD;AAAA,iBAAM;AACvIT,YAAAA,KAAK,EAAES,CAAC,CAAC6D,aAD8H;AAEvIC,YAAAA,KAAK,EAAE9D,CAAC,CAAC+D;AAF8H,WAAN;AAAA,SAAzB,CAA5G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAKI,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAC,QAAd;AAAuB,QAAA,IAAI,EAAC,IAA5B;AAAiC,QAAA,OAAO,EAAE;AAAA,iBAAK,MAAI,CAACtD,QAAL,CAAc;AAAEa,YAAAA,WAAW,EAAE;AAAf,WAAd,CAAL;AAAA,SAA1C;AAAkF,QAAA,SAAS,EAAC,OAA5F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBALJ,CAD0F,EAU1FoC,IAAI,CAACF,GAAL,CAAS,UAAAxD,CAAC;AAAA,eACN,oBAAC,SAAD;AAAW,UAAA,KAAK,MAAhB;AAAiB,UAAA,GAAG,EAAEA,CAAC,CAACgE,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI,oBAAC,aAAD;AACI,UAAA,SAAS,EAAC,gEADd;AAEI,UAAA,OAAO,EAAE,iBAAA3C,CAAC;AAAA,mBAAIA,CAAC,CAAC4C,cAAF,EAAJ;AAAA,WAFd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAII;AAAK,UAAA,SAAS,EAAC,sCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,iCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACA,oBAAC,MAAD;AAAQ,UAAA,IAAI,EAAC,IAAb;AAAkB,UAAA,KAAK,EAAC,SAAxB;AAAkC,UAAA,OAAO,EAAE;AAAA,mBAAK,MAAI,CAACC,YAAL,CAAkBlE,CAAC,CAACgE,OAApB,EAA8BhE,CAAC,CAACmE,aAAhC,CAAL;AAAA,WAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADA,CADJ,CADA,EAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACQnE,CAAC,CAACoE,QADV,cACsBpE,CAAC,CAACqE,OADxB,EANA,CAJJ,EAcI;AAAI,UAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA2BrE,CAAC,CAACsE,IAA7B,CAdJ,EAeI;AAAG,UAAA,SAAS,EAAC,cAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACItE,CAAC,CAACuE,UADN,cACoBvE,CAAC,CAACwE,aADtB,cACuCxE,CAAC,CAACyE,QADzC,EAfJ,CADJ,CADM;AAAA,OAAV,CAV0F,CAjBlG,CADJ;AAsDH;;;;EAlNsChG,S;;SAAtBY,Y","sourcesContent":["import React, { Component } from 'react';\r\nimport Page from 'layouts/page-admin';\r\nimport Autosuggest from 'react-autosuggest';\r\nimport './src.css';\r\nimport { Row , \r\n         Col , \r\n         Button,\r\n         ListGroupItem,\r\n         ListGroup\r\n        } from 'reactstrap';\r\nimport app from 'app';\r\nimport download from 'downloadjs';\r\nimport Loading from 'layouts/loading-modal';\r\nimport Select from 'react-select';\r\n\r\n\r\nexport default class SearchReport  extends Component {\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n          value: '',\r\n          suggestions: [],\r\n          laporan: [],\r\n          result: [],\r\n          modal: false,\r\n          accperiod:[],\r\n          filtervalue:'',\r\n          currentPage: 1,\r\n          todosPerPage: 3\r\n        }\r\n        this.handleClick = this.handleClick.bind(this);\r\n      }\r\n\r\n      handleClick(event) {\r\n        this.setState({\r\n          currentPage: Number(event.target.id)\r\n        });\r\n      }\r\n\r\n      componentWillMount(){\r\n        let user = app.dataUser[0].ACCESS;\r\n        let dpt = app.dataUser[0].IDDPT || 'IDO';\r\n\r\n        app.apiGet2('search/repo',user , dpt)\r\n           .then(res=>{\r\n               this.setState({ laporan: res});\r\n           })\r\n        \r\n        app.apiGet('accperiod')\r\n           .then(res =>{\r\n             this.setState({\r\n               accperiod: res\r\n            })\r\n\r\n        })\r\n      }\r\n\r\n    \r\n      getSuggestions = value => {\r\n        let { laporan } = this.state;\r\n        const inputValue = value.trim().toLowerCase();\r\n        const inputLength = inputValue.length;\r\n      \r\n        return inputLength === 0 ? [] : laporan.filter(x =>\r\n          x.REPOSITORY.toLowerCase().slice(0, inputLength) === inputValue\r\n        );\r\n\r\n      };\r\n      \r\n    \r\n      getSuggestionValue = suggestion => suggestion.REPOSITORY;\r\n    \r\n      renderSuggestion = suggestion => (\r\n        <div>\r\n          {suggestion.REPOSITORY}\r\n        </div>\r\n      );\r\n    \r\n      onChange = (event, { newValue }) => {\r\n        this.setState({\r\n          value: newValue\r\n        });\r\n      };\r\n    \r\n      onSuggestionsFetchRequested = ({ value }) => {\r\n        this.setState({\r\n          suggestions: this.getSuggestions(value)\r\n        });\r\n\r\n      };\r\n    \r\n      onSuggestionsClearRequested = () => {\r\n        this.setState({\r\n          suggestions: []\r\n        });\r\n      };\r\n\r\n      Search =()=>{\r\n          let { value } = this.state;\r\n          app.apiGet1('search/file',value || 'test')\r\n             .then(res =>{\r\n                 this.setState({ result: res})\r\n             })\r\n\r\n      }\r\n\r\n      mode =()=>{\r\n        this.setState({\r\n            modal: !this.state.modal\r\n        })\r\n     }   \r\n\r\n      async Downloadfile(id , name){\r\n\r\n        this.mode();\r\n \r\n        let res = await fetch(app.proxy+'downloadfile/'+id ,{\r\n            method: 'get',\r\n            headers: app.head2\r\n        });\r\n \r\n        if (res) {\r\n         let blob = await res.blob();\r\n     \r\n         download(blob , name);\r\n         this.mode();\r\n         app.apiGet1('deletefile',id)  \r\n \r\n        }\r\n     }\r\n\r\n     FilterResult = (e)=>{\r\n        this.setState({ filtervalue: e.value});\r\n     }\r\n\r\n    \r\n    render() {\r\n\r\n        const { value, suggestions , result , filtervalue  , currentPage, todosPerPage} = this.state;\r\n\r\n        const inputProps = {\r\n        placeholder: 'Cari Laporan Anda',\r\n        value,\r\n        onChange: this.onChange\r\n        };\r\n\r\n        const indexOfLastTodo = currentPage * todosPerPage;\r\n        const indexOfFirstTodo = indexOfLastTodo - todosPerPage;\r\n        const currentTodos = result.slice(indexOfFirstTodo, indexOfLastTodo);\r\n\r\n\r\n        const pageNumbers = [];\r\n        for (let i = 1; i <= Math.ceil(result.length / todosPerPage); i++) {\r\n          pageNumbers.push(i);\r\n        }\r\n\r\n        const renderPageNumbers = pageNumbers.map(number => {\r\n          return (\r\n            <li\r\n              key={number}\r\n              id={number}\r\n              onClick={this.handleClick}\r\n            >\r\n              {number}\r\n            </li>\r\n          );\r\n        });\r\n\r\n        const data =  result.filter(x => { \r\n            return x.ID_PERIOD.toLowerCase().includes(filtervalue.toLowerCase())\r\n        });\r\n          \r\n        return (\r\n            <Page head={'Pencarian Laporan'}>\r\n                <Loading modal={this.state.modal} text={'Proses Download'}/>\r\n                <Row className='mb-3'>\r\n                    <Col md='12'>\r\n                    <Autosuggest \r\n                        suggestions={suggestions}\r\n                        onSuggestionsFetchRequested={this.onSuggestionsFetchRequested}\r\n                        onSuggestionsClearRequested={this.onSuggestionsClearRequested}\r\n                        getSuggestionValue={this.getSuggestionValue}\r\n                        renderSuggestion={this.renderSuggestion}\r\n                        inputProps={inputProps}\r\n                    />\r\n                    </Col>\r\n                </Row> \r\n                <Button color='primary' onClick={this.Search}> Search </Button>\r\n                <hr />\r\n                {  \r\n                    currentTodos.length === 0 ? <div className='text-center'><h1> Data Tidak Ada </h1></div> :<div>\r\n                    <div className='row mb-2'>\r\n                        <Select id='period' className='col-3' onChange={this.FilterResult} placeholder={'Filter Periode'}  options={this.state.accperiod.map((x)=>({\r\n                            value: x.VCIDACCPERIOD,\r\n                            label: x.VCDESCRIPTION\r\n                        }))} />\r\n                        <Button color='danger' size='sm' onClick={()=> this.setState({ filtervalue: ''})} className='col-1'>Clear Filter</Button>\r\n                    </div>\r\n                   \r\n                    {\r\n                    data.map(x =>(\r\n                        <ListGroup flush key={x.ID_FILE}>\r\n                            <ListGroupItem\r\n                                className=\"list-group-item-action flex-column align-items-start py-4 px-4\"\r\n                                onClick={e => e.preventDefault()}\r\n                            >\r\n                                <div className=\"d-flex w-100 justify-content-between\">\r\n                                <div>\r\n                                    <div className=\"d-flex w-100 align-items-center\">\r\n                                    <Button size='sm' color='success' onClick={()=> this.Downloadfile(x.ID_FILE , x.ORIGINAL_NAME)}> Download </Button>\r\n                                    </div>\r\n                                </div>\r\n                                <small>\r\n                                    {`${x.DIVISION} ${x.PERIODE}`}\r\n                                </small>\r\n                                </div>\r\n                                <h4 className=\"mt-3 mb-1\">{x.REPO}</h4>\r\n                                <p className=\"text-sm mb-0\">\r\n                                {`${x.JENIS_REPO} ${x.TEMPLATE_NAME} ${x.DTUPLOAD}`}\r\n                                </p>\r\n                            </ListGroupItem>\r\n                        </ListGroup>))  }  \r\n                        </div>\r\n                }\r\n            </Page>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}