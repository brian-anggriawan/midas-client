{"ast":null,"code":"import _classCallCheck from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\job\\\\web\\\\Midas\\\\Midas-Client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport Decode from 'jwt-decode';\nimport app from 'app';\n\nvar AuthService =\n/*#__PURE__*/\nfunction () {\n  function AuthService() {\n    _classCallCheck(this, AuthService);\n  }\n\n  _createClass(AuthService, [{\n    key: \"login\",\n    value: function login(user, pass) {\n      var data = {\n        name: user,\n        pass: pass\n      };\n      return app.apiPostJson('/login', data).then(function (res) {\n        localStorage.setItem('token', res.token);\n      });\n    }\n  }, {\n    key: \"loggedin\",\n    value: function loggedin() {\n      var token = localStorage.getItem('token');\n      return !!token && !this.isTokenExpired(token);\n    }\n  }, {\n    key: \"isTokenExpired\",\n    value: function isTokenExpired(token) {\n      try {\n        var decode = Decode(token);\n\n        if (decode.exp < Date.now() / 1000) {\n          return true;\n        } else {\n          return false;\n        }\n      } catch (err) {\n        return false;\n      }\n    }\n  }, {\n    key: \"getProfile\",\n    value: function getProfile() {\n      return Decode(localStorage.getItem('token'));\n    }\n  }, {\n    key: \"logout\",\n    value: function logout() {\n      localStorage.removeItem('token');\n    }\n  }]);\n\n  return AuthService;\n}();\n\nexport { AuthService as default };","map":{"version":3,"sources":["D:\\job\\web\\Midas\\Midas-Client\\src\\AuthService.js"],"names":["Decode","app","AuthService","user","pass","data","name","apiPostJson","then","res","localStorage","setItem","token","getItem","isTokenExpired","decode","exp","Date","now","err","removeItem"],"mappings":";;AAAA,OAAOA,MAAP,MAAmB,YAAnB;AACA,OAAOC,GAAP,MAAgB,KAAhB;;IAEqBC,W;;;;;;;;;0BAEXC,I,EAAOC,I,EAAK;AACd,UAAIC,IAAI,GAAG;AACPC,QAAAA,IAAI,EAAEH,IADC;AAEPC,QAAAA,IAAI,EAAEA;AAFC,OAAX;AAIA,aAAOH,GAAG,CAACM,WAAJ,CAAgB,QAAhB,EAA0BF,IAA1B,EACIG,IADJ,CACS,UAAAC,GAAG,EAAG;AACVC,QAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA+BF,GAAG,CAACG,KAAnC;AACD,OAHJ,CAAP;AAIH;;;+BAES;AACN,UAAIA,KAAK,GAAGF,YAAY,CAACG,OAAb,CAAqB,OAArB,CAAZ;AACA,aAAO,CAAC,CAACD,KAAF,IAAW,CAAC,KAAKE,cAAL,CAAoBF,KAApB,CAAnB;AAEH;;;mCAEcA,K,EAAM;AACjB,UAAG;AACC,YAAIG,MAAM,GAAGf,MAAM,CAACY,KAAD,CAAnB;;AAEA,YAAIG,MAAM,CAACC,GAAP,GAAaC,IAAI,CAACC,GAAL,KAAa,IAA9B,EAAmC;AAC/B,iBAAO,IAAP;AACH,SAFD,MAEK;AACD,iBAAO,KAAP;AACH;AACJ,OARD,CAUA,OAAMC,GAAN,EAAU;AACN,eAAO,KAAP;AACH;AACJ;;;iCAEW;AACR,aAAOnB,MAAM,CAACU,YAAY,CAACG,OAAb,CAAqB,OAArB,CAAD,CAAb;AACH;;;6BAEO;AACJH,MAAAA,YAAY,CAACU,UAAb,CAAwB,OAAxB;AACH;;;;;;SAzCgBlB,W","sourcesContent":["import Decode from 'jwt-decode';\r\nimport app from 'app';\r\n\r\nexport default class AuthService{\r\n    \r\n    login(user , pass){\r\n        let data = {\r\n            name: user,\r\n            pass: pass\r\n        }\r\n        return app.apiPostJson('/login', data)\r\n                  .then(res =>{\r\n                    localStorage.setItem('token' , res.token)\r\n                  })\r\n    }\r\n\r\n    loggedin(){\r\n        let token = localStorage.getItem('token');\r\n        return !!token && !this.isTokenExpired(token)\r\n\r\n    }\r\n\r\n    isTokenExpired(token){\r\n        try{\r\n            let decode = Decode(token);\r\n\r\n            if (decode.exp < Date.now() / 1000){\r\n                return true\r\n            }else{\r\n                return false\r\n            }\r\n        }\r\n\r\n        catch(err){\r\n            return false;\r\n        }\r\n    }\r\n\r\n    getProfile(){\r\n        return Decode(localStorage.getItem('token'));\r\n    }\r\n\r\n    logout(){\r\n        localStorage.removeItem('token')\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}